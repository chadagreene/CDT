
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>sam documentation</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-02-11"><meta name="DC.source" content="sam_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>sam</tt> documentation</h1><!--introduction--><p><tt>sam</tt> computes a version of the Southern Annular Mode index, also known as the Antarctic Oscillation.</p><p><a href="CDT_Contents.html">Back to Climate Data Tools Contents</a></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example</a></li><li><a href="#4">Load Data</a></li><li><a href="#5">Plot pressure data</a></li><li><a href="#6">Calculate SAM index</a></li><li><a href="#8">Getting zonal mean pressures</a></li><li><a href="#10">Reference</a></li><li><a href="#11">Author Info</a></li></ul></div><h2 id="1">Syntax</h2><pre>idx = sam(slp40,slp65,t)</pre><h2 id="2">Description</h2><p><tt>idx = sam(slp40,slp65,t)</tt> calculates the Southern Annular Mode index from two time series of sea-level pressures at two latitudes (40S and 65S) and their corresponding times <tt>t</tt>.</p><h2 id="3">Example</h2><p>Here, we'll recreate Figure 7 from Marshall's classic 2003 paper, Trends in the Southern Annular Mode from observations and reanalyses (Marshall, <a href="https://journals.ametsoc.org/doi/pdf/10.1175/1520-0442%282003%29016%3C4134%3ATITSAM%3E2.0.CO%3B2">2003</a>), which depicts the monthly SAM index.</p><h2 id="4">Load Data</h2><p>We can load data containing zonal-mean SLP at 40S and 65S calculated from observations from 1957 January to 2018 December.</p><pre class="codeinput">load <span class="string">sam_slp_data.mat</span>
</pre><h2 id="5">Plot pressure data</h2><p>The sam_slp_data.mat file contains monthly zonal mean pressures from 1957 to 2018. (A note on how to get these types of zonal mean pressures from gridded data appears at the bottom of this page.) Here is the pressure data we'll use to calculate SAM:</p><pre class="codeinput">figure
plot(t,slp40);
hold <span class="string">on</span>
plot(t,slp65)
axis <span class="string">tight</span>
legend(<span class="string">'mean SLP at 40\circS'</span>,<span class="string">'mean SLP at 65\circS'</span>)
</pre><img vspace="5" hspace="5" src="sam_documentation_01.png" alt=""> <h2 id="6">Calculate SAM index</h2><p>The <tt>sam</tt> function normalizes each time series relative to a 1971-2000 baseline, and differences the two pressure anomaly time series to yield the SAM index.</p><pre class="codeinput"><span class="comment">% Calculate SAM index:</span>
sam_idx = sam(slp40,slp65,t);

figure
plot(t,sam_idx,<span class="string">':'</span>,<span class="string">'color'</span>,rgb(<span class="string">'gray'</span>));
hold <span class="string">on</span>
plot(t,movmean(sam_idx,12),<span class="string">'k'</span>,<span class="string">'linewidth'</span>,1)
ylabel(<span class="string">'SAM Index'</span>)
xlabel(<span class="string">'Year'</span>)
xlim([datetime(1955,1,1) datetime(2005,1,1)]) <span class="comment">% sets date limits</span>
ylim([-8 8])                                  <span class="comment">% sets vertical limits</span>
hline(0,<span class="string">'k--'</span>)                                <span class="comment">% draws horizontal line</span>
</pre><img vspace="5" hspace="5" src="sam_documentation_02.png" alt=""> <p>Above, the built-in Matlab function <tt>movmean</tt> was used to calculate the 12 month moving mean, and a horizontal dashed line was drawn with <a href="hline_documentation.html"><tt>hline</tt></a> to match Marshall's Figure 7.</p><h2 id="8">Getting zonal mean pressures</h2><p>The example above begins by loading zonal mean pressures from 40S and 65S. If you're working with gridded data you'll need to calculate the zonal means at 40S and 65S. Do that like this. Start by loading some example data: (using <a href="ncdateread_documentation.html"><tt>ncdateread</tt></a> to read the date time).</p><pre class="codeinput">lat = double(ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'latitude'</span>));
lon = double(ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'longitude'</span>));
t = ncdateread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'time'</span>);
sp = ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'sp'</span>);
</pre><p>A brute force way to get the zonal means at 40S and 65S is to interpolate to 40S and 65S at each unique longitude in the grid, and then average the results, for each timestep. Begin by preallocating the outputs, then loop through each time step, interpolating to 40S and 65S</p><pre class="codeinput"><span class="comment">% Preallocate zonal mean pressure time series:</span>
slp40 = NaN(size(t));
slp65 = NaN(size(t));

<span class="comment">% Loop through each time step:</span>
<span class="keyword">for</span> k = 1:length(t)

   <span class="comment">% Take the mean of SLPs at all longitides, interpolated to 40S:</span>
   slp40(k) = mean(interp2(lat,lon,sp(:,:,k),-40*ones(size(lon)),lon));

   <span class="comment">% Take the mean of SLPs at all longitides, interpolated to 65S:</span>
   slp65(k) = mean(interp2(lat,lon,sp(:,:,k),-65*ones(size(lon)),lon));
<span class="keyword">end</span>

figure
plot(t,slp40)
hold <span class="string">on</span>
plot(t,slp65)

legend(<span class="string">'mean SLP at 40\circS'</span>,<span class="string">'mean SLP at 65\circS'</span>)
</pre><img vspace="5" hspace="5" src="sam_documentation_03.png" alt=""> <h2 id="10">Reference</h2><p>Marshall, G. J., 2003: Trends in the Southern Annular Mode from observations and reanalyses. J. Clim., 16, 4134-4143.</p><h2 id="11">Author Info</h2><p>The <tt>enso</tt> function and supporting documentation were written by <a href="Kaustubh">Thirumalai &lt;http://www.kaustubh.info</a>&gt;</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |sam| documentation 
% |sam| computes a version of the Southern Annular Mode index, also known as
% the Antarctic Oscillation.
%
% <CDT_Contents.html Back to Climate Data Tools Contents>
%% Syntax 
% 
%  idx = sam(slp40,slp65,t) 
% 
%% Description 
% 
% |idx = sam(slp40,slp65,t)| calculates the Southern Annular Mode index 
% from two time series of sea-level pressures at two latitudes (40S and 65S) 
% and their corresponding times |t|. 
% 
%% Example
% Here, we'll recreate Figure 7 from Marshall's classic 2003 paper, 
% Trends in the Southern Annular Mode from observations and reanalyses 
% (Marshall, <https://journals.ametsoc.org/doi/pdf/10.1175/1520-0442%282003%29016%3C4134%3ATITSAM%3E2.0.CO%3B2 
% 2003>), which depicts the monthly SAM index.

%% Load Data 
% We can load data containing zonal-mean SLP at 40S and 65S calculated
% from observations from 1957 January to 2018 December.

load sam_slp_data.mat

%% Plot pressure data
% The sam_slp_data.mat file contains monthly zonal mean pressures from 1957
% to 2018. (A note on how to get these types of zonal mean pressures from
% gridded data appears at the bottom of this page.) Here is the pressure
% data we'll use to calculate SAM:

figure
plot(t,slp40); 
hold on
plot(t,slp65)
axis tight
legend('mean SLP at 40\circS','mean SLP at 65\circS') 

%% Calculate SAM index
% The |sam| function normalizes each time series relative to a 1971-2000
% baseline, and differences the two pressure anomaly time series to yield the
% SAM index. 

% Calculate SAM index: 
sam_idx = sam(slp40,slp65,t);

figure
plot(t,sam_idx,':','color',rgb('gray'));
hold on
plot(t,movmean(sam_idx,12),'k','linewidth',1)
ylabel('SAM Index')
xlabel('Year')
xlim([datetime(1955,1,1) datetime(2005,1,1)]) % sets date limits
ylim([-8 8])                                  % sets vertical limits
hline(0,'kREPLACE_WITH_DASH_DASH')                                % draws horizontal line 

%% 
% Above, the built-in Matlab function |movmean| was used to calculate the
% 12 month moving mean, and a horizontal dashed line was drawn with
% <hline_documentation.html |hline|> to match Marshall's Figure 7. 

%% Getting zonal mean pressures
% The example above begins by loading zonal mean pressures from 40S and
% 65S. If you're working with gridded data you'll need to calculate the
% zonal means at 40S and 65S. Do that like this. Start by loading some
% example data: (using <ncdateread_documentation.html |ncdateread|> to read
% the date time). 

lat = double(ncread('ERA_Interim_2017.nc','latitude'));
lon = double(ncread('ERA_Interim_2017.nc','longitude'));
t = ncdateread('ERA_Interim_2017.nc','time');
sp = ncread('ERA_Interim_2017.nc','sp');

%% 
% A brute force way to get the zonal means at 40S and 65S is to interpolate
% to 40S and 65S at each unique longitude in the grid, and then average the
% results, for each timestep. Begin by preallocating the outputs, then loop
% through each time step, interpolating to 40S and 65S

% Preallocate zonal mean pressure time series: 
slp40 = NaN(size(t)); 
slp65 = NaN(size(t)); 

% Loop through each time step: 
for k = 1:length(t)
   
   % Take the mean of SLPs at all longitides, interpolated to 40S:
   slp40(k) = mean(interp2(lat,lon,sp(:,:,k),-40*ones(size(lon)),lon)); 
   
   % Take the mean of SLPs at all longitides, interpolated to 65S:
   slp65(k) = mean(interp2(lat,lon,sp(:,:,k),-65*ones(size(lon)),lon)); 
end

figure
plot(t,slp40)
hold on
plot(t,slp65)

legend('mean SLP at 40\circS','mean SLP at 65\circS') 

%% Reference
% 
% Marshall, G. J., 2003: Trends in the Southern Annular Mode 
% from observations and reanalyses. J. Clim., 16, 4134-4143.

%% Author Info
% The |enso| function and supporting documentation were written by <Kaustubh Thirumalai http://www.kaustubh.info> 
##### SOURCE END #####
--></body></html>