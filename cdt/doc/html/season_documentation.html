
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>season documentation</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-07-18"><meta name="DC.source" content="season_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>season</tt> documentation</h1><!--introduction--><p><tt>season</tt> estimates anomalies associated with the annual cycle or of a time series.</p><p>See also:  <a href="deseason_documentation.html"><tt>deseason</tt></a>, <a href="climatology_documentation.html"><tt>climatology</tt></a>, <a href="sinefit_documentation.html"><tt>sinefit</tt></a>, <a href="sineval_documentation.html"><tt>sineval</tt></a>, and <a href="sinefit_bootstrap_documentation.html"><tt>sinefit_bootstrap</tt></a>.</p><p><a href="CDT_Contents.html">Back to Climate Data Tools Contents</a></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example 1: A single time series</a></li><li><a href="#7">Example 2: Multiple time series at once</a></li><li><a href="#10">Removing seasonal cycles</a></li><li><a href="#11">Example 3: Real Sea Ice Data</a></li><li><a href="#13">Example 4: Gridded reanalysis data</a></li><li><a href="#16">How this function works</a></li><li><a href="#17">Seasons vs Climatology</a></li><li><a href="#19">Other ways to define seasonality</a></li><li><a href="#20">Author Info</a></li></ul></div><h2 id="1">Syntax</h2><pre>[As,ts] = season(A,t)
[As,ts] = season(...,'daily')
[As,ts] = season(...,'monthly')
[As,ts] = season(...,'detrend',DetrendOption)
[As,ts] = season(...,'dim',dimension)
As = season(...,'full')</pre><h2 id="2">Description</h2><p><tt>[As,ts] = season(A,t)</tt> gives the typical seasonal (aka annual) cycle of the time series <tt>A</tt> corresponding to times <tt>t</tt> in datenum or datetime format. If <tt>t</tt> is daily, outputs <tt>ts</tt> is 1 to 366 and <tt>As</tt> will contain average values for each of the 366 days of the year. If inputs are monthly, <tt>ts</tt> is 1:12 and <tt>As</tt> will contain average values for each of the 12 months of the year.</p><p><tt>[As,ts] = season(...,'daily')</tt> specifies directly that inputs are daily resolution. The season function will typically figure this out automatically, but if you have large missing gaps in your data you may wish to ensure correct results by specifying daily.</p><p><tt>[As,ts] = season(...,'monthly')</tt> as above, but forces monthly solution.</p><p><tt>[As,ts] = season(...,'detrend',DetrendOption)</tt> specifies a baseline relative to which seasonal anomalies are determined. Options are <tt>'linear'</tt>, <tt>'quadratic'</tt>, <tt>'mean'}, or |'none'</tt>. By default, anomalies are calculated after removing the linear least squares trend, but if, for example, warming is strongly nonlinear, you may prefer the <tt>'quadratic'</tt> option. Default is <tt>'linear'</tt>.</p><p><tt>[As,ts] = season(...,'dim',dimension)</tt> specifies a dimension along which to assess seasons. By default, if <tt>A</tt> is 1D, seasonal cycle is returned along the nonsingleton dimension; if <tt>A</tt> is 2D, season is performed along dimension 1 (time marches down the rows); if <tt>A</tt> is 3D, season is performed along dimension 3.</p><p><tt>As = season(...,'full')</tt> returns <tt>As</tt> for the entire time series <tt>A</tt>. This is a convenient option for looking at the components of a long time series separately.</p><h2 id="3">Example 1: A single time series</h2><p>Consider this time series. Let's call it temperature:</p><pre class="codeinput">t = datenum(<span class="string">'jan 1, 1979'</span>):datenum(<span class="string">'dec 31, 2016'</span>);

<span class="comment">% Sinusoidal seasonal signal + warming trend + noise + some mean value:</span>
T = 4*sin(doy(t,<span class="string">'decimalyear'</span>)*2*pi) + (t-min(t))/5e3 + randn(size(t)) + 15;

plot(t,T)
axis <span class="string">tight</span>
box <span class="string">off</span>
datetick(<span class="string">'x'</span>,<span class="string">'keeplimits'</span>)
</pre><img vspace="5" hspace="5" src="season_documentation_01.png" alt=""> <p>You can see the temperature has a seasonal cycle, but there's a gradual warming over time and there's also some random noise in there. To see the structure of the seasonal cycle a little better, we can look at the same time series as a function of day of year using the <a href="doy_documentation.html"><tt>doy</tt></a> function. We'll also use the <a href="cbdate_documentation.html"><tt>cbdate</tt></a> function to format the colorbar dates.</p><pre class="codeinput">figure
scatter(doy(t),T,10,t,<span class="string">'filled'</span>)
axis <span class="string">tight</span>

colorbar
cbdate(<span class="string">'yyyy'</span>)
xlabel <span class="string">'day of year'</span>
ylabel <span class="string">'temperature'</span>
cmocean <span class="string">amp</span>
</pre><img vspace="5" hspace="5" src="season_documentation_02.png" alt=""> <p>And again you can see the temperature rising over time, but by plotting as a function of <tt>doy</tt> we get to see the structure of the seasonal cycle a little better. Now what if we want to separate the effects of long-term warming from the seasonal cycle?</p><pre class="codeinput">Ts = season(T,t);

figure
plot(1:366,Ts)
box <span class="string">off</span>
axis <span class="string">tight</span>
xlabel <span class="string">'day of year'</span>
ylabel <span class="string">'seasonal temperature cycle'</span>
</pre><img vspace="5" hspace="5" src="season_documentation_03.png" alt=""> <p>Above we see the seasonal cycle that has an amplitude of 4 degrees, just as we defined it. Some noise remains because each day of the year represents the average of 38 noisy measurements. Nonetheless, it's our best approximation of the seasonal cycle, and it's pretty close.</p><h2 id="7">Example 2: Multiple time series at once</h2><p>Let's say you have several rows of data, each containing a different time series. The data might look like this (we're building on the time series <tt>T</tt> from above)</p><pre class="codeinput">T2 = [T + (t-min(t))/2e3;
      T - 15*cos(doy(t,<span class="string">'decimalyear'</span>)*2*pi) + (t-min(t))/1e2;
      T + ((t-min(t))/2.5e3).^3.1];

figure
plot(t,T2)
axis <span class="string">tight</span>
box <span class="string">off</span>
datetick(<span class="string">'x'</span>,<span class="string">'keeplimits'</span>)
legend(<span class="string">'first row of T2'</span>,<span class="string">'second row of T2'</span>,<span class="string">'third row of T2'</span>,<span class="string">'location'</span>,<span class="string">'northwest'</span>)
legend <span class="string">boxoff</span>
</pre><img vspace="5" hspace="5" src="season_documentation_04.png" alt=""> <p>What's the annual cycle like for each of those time series? Use <tt>season</tt>, but specify dimension 2 because each row of <tt>T2</tt> contains a time series. If each column of <tt>T2</tt> contained a time series, the default dimension 1 would be what we want.</p><p>Let's also get the whole time series with the <tt>'full'</tt> option rather than the default days 1 to 366.</p><pre class="codeinput">T2_full = season(T2,t,<span class="string">'dimension'</span>,2,<span class="string">'full'</span>);

figure
plot(t,T2_full)
axis([datenum(<span class="string">'jan 1, 1995'</span>) datenum(<span class="string">'jan 1, 2010'</span>) -16 16])
box <span class="string">off</span>
datetick(<span class="string">'x'</span>,<span class="string">'keeplimits'</span>)

legend(<span class="string">'first row of T2'</span>,<span class="string">'second row of T2'</span>,<span class="string">'third row of T2'</span>,<span class="string">'location'</span>,<span class="string">'northwest'</span>)
</pre><img vspace="5" hspace="5" src="season_documentation_05.png" alt=""> <p>Above we see that <tt>season</tt> has extracted the seasonal cycles of each time series in <tt>T2</tt>. Even row 3 of <tt>T2</tt>, which has a long term trend that scales to the power of 3.1 is sufficiently analyzed using the default linear detrending. However, if linear detrending is insufficient for your application, use the <tt>'detrend','quadratic'</tt> option to step it up a notch.</p><h2 id="10">Removing seasonal cycles</h2><p>For convenience, the Climate Data Toolbox has a <a href="deseason_documentation.html"><tt>deseason</tt></a> function, but it's worth noting here, that the <tt>deseason</tt> function removes seasonal cycles just by subtracting the seasonal component from the original signals, like this:</p><pre class="codeinput">T_deseasoned = T2 - T2_full;

figure
plot(t,T2)
hold <span class="string">on</span>

plot(t,T_deseasoned)
axis <span class="string">tight</span>
box <span class="string">off</span>
datetick(<span class="string">'x'</span>,<span class="string">'keeplimits'</span>)
legend(<span class="string">'first row of T2'</span>,<span class="string">'second row of T2'</span>,<span class="string">'third row of T2'</span>,<span class="string">'location'</span>,<span class="string">'northwest'</span>)
legend <span class="string">boxoff</span>
</pre><img vspace="5" hspace="5" src="season_documentation_06.png" alt=""> <h2 id="11">Example 3: Real Sea Ice Data</h2><p>The examples above used some artifical data we created. But how does this function apply to real data? Let's compare the northern and southern hemisphere seasonal cycles of sea ice extent. Here's what the full time series look like:</p><pre class="codeinput">load <span class="string">seaice_extent</span>

figure
plot(t,extent_N,<span class="string">'b'</span>)
hold <span class="string">on</span>
plot(t,extent_S,<span class="string">'r'</span>)

axis <span class="string">tight</span>
box <span class="string">off</span>
legend(<span class="string">'north'</span>,<span class="string">'south'</span>,<span class="string">'location'</span>,<span class="string">'northwest'</span>)
</pre><img vspace="5" hspace="5" src="season_documentation_07.png" alt=""> <p>So what's a typical year of sea ice look like?</p><pre class="codeinput">figure
plot(season(extent_N,t),<span class="string">'b'</span>)
hold <span class="string">on</span>
plot(season(extent_S,t),<span class="string">'r'</span>)

axis <span class="string">tight</span>
box <span class="string">off</span>
xlabel <span class="string">'day of year'</span>
ylabel(<span class="string">'sea ice extent anomaly (10^6 km^2)'</span>)
ntitle(<span class="string">' typical seasonal cycle '</span>)
legend(<span class="string">'north'</span>,<span class="string">'south'</span>,<span class="string">'location'</span>,<span class="string">'northwest'</span>)
</pre><img vspace="5" hspace="5" src="season_documentation_08.png" alt=""> <h2 id="13">Example 4: Gridded reanalysis data</h2><p>Let's explore the typical seasonal cycles of sea surface temperatures. Here's a monthly dataset of dimensions 60x55x802:</p><pre class="codeinput">load <span class="string">pacific_sst</span>

sst_season = season(sst,t);
</pre><p>That gives us <tt>sst_season</tt>, which is 60x55x12, representing one 60x55 grid for each month of the year. Take the difference between the typical maximum and minimum temperatures to get a sense of how strong the seasons are in different parts of the Pacific:</p><pre class="codeinput">T_range = max(sst_season,[],3)-min(sst_season,[],3);

figure
imagescn(lon,lat,T_range)
cb = colorbar;
ylabel(cb,<span class="string">'magnitude of seasonal cycle (\circ C)'</span>)
cmocean <span class="string">amp</span>
</pre><img vspace="5" hspace="5" src="season_documentation_09.png" alt=""> <p>That's not surprising--Seasonality is strongest close to the poles and in shallow waters.</p><h2 id="16">How this function works</h2><p>By default, the <tt>season</tt> function removes the linear trend from a time series, then determines the climatology of the time series by averaging all detrended data for each day (or month) of the year.</p><p>For daily data, Leap Years present a challenge. This function calculates the average temperature for February 28th by averaging all data corresponding to the 59th day of the year. But what to do about March 1st? Most years March 1st is the 60th day of the year, but every fourth year March 1st is the 61st day of the year.</p><p>This function converts all dates to the day of the year, and calculates seasonal cycles as a function of day of the year. Since there are far fewer years with 366 days, applying the same practice of averaging all data from day 366 would make day 366 sensitive to outliers. Thus, for day 366, the <tt>season</tt> function averages all data from day 365, day 366, and day 1 of all years.</p><h2 id="17">Seasons vs Climatology</h2><p>CDT has a function called <tt>season</tt> and another function called <a href="climatology_documentation.html"><tt>climatology</tt></a>. The only difference is that the output of <tt>climatology</tt> includes the mean of the variable, whereas the output of <tt>season</tt> will always have a 0 mean value. Accordingly, the <a href="deseason_documentation.html"><tt>deseason</tt></a> function removes the seasonal component of variability while preserving the overall mean and trends.</p><p>In general, CDT assumes that a multi-year record of a variable sampled at subannual resolution can described by</p><pre>y = y_0 + y_tr + y_season + y_var + y_noise</pre><p>where</p><div><ul><li><tt>y_0</tt> is the long-term <tt>mean</tt>,</li><li><tt>y_trend</tt> is the long-term <a href="trend_documentation.html"><tt>trend</tt></a>,</li><li><tt>y_season</tt> is the typical seasonal anomaly, which the <tt>season</tt> function obtains after detrending and removing the mean,</li><li><tt>y_var</tt> represents interannual variability, and</li><li><tt>y_noise</tt> is everything else</li></ul></div><p>In this model,</p><pre>y_climatology = y_0 + y_season</pre><h2 id="19">Other ways to define seasonality</h2><p>For yet another way to define seasonality, see <a href="sinefit_documentation.html"><tt>sinefit</tt></a>, <a href="sineval_documentation.html"><tt>sineval</tt></a>, and <a href="sinefit_bootstrap_documentation.html"><tt>sinefit_bootstrap</tt></a>.</p><h2 id="20">Author Info</h2><p>This function was written by <a href="http://www.chadagreene.com">Chad A. Greene</a> of the University of Texas Institute for Geophysics (UTIG), July 2017.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |season| documentation 
% |season| estimates anomalies associated with the annual cycle or of a time series. 
%
% See also:  <deseason_documentation.html |deseason|>, <climatology_documentation.html |climatology|>, <sinefit_documentation.html |sinefit|>, 
% <sineval_documentation.html |sineval|>, and <sinefit_bootstrap_documentation.html |sinefit_bootstrap|>. 
% 
% <CDT_Contents.html Back to Climate Data Tools Contents>
%% Syntax 
% 
%  [As,ts] = season(A,t) 
%  [As,ts] = season(...,'daily')  
%  [As,ts] = season(...,'monthly') 
%  [As,ts] = season(...,'detrend',DetrendOption) 
%  [As,ts] = season(...,'dim',dimension) 
%  As = season(...,'full') 
% 
%% Description 
% 
% |[As,ts] = season(A,t)| gives the typical seasonal (aka annual) cycle of the time series |A| corresponding
% to times |t| in datenum or datetime format. If |t| is daily, outputs |ts| is 1 to 366 and |As| will contain average values
% for each of the 366 days of the year. If inputs are monthly, |ts| is 1:12 and |As| will contain average values
% for each of the 12 months of the year. 
%
% |[As,ts] = season(...,'daily')| specifies directly that inputs are daily resolution. The season function
% will typically figure this out automatically, but if you have large missing gaps in your data you may wish
% to ensure correct results by specifying daily. 
% 
% |[As,ts] = season(...,'monthly')| as above, but forces monthly solution. 
%
% |[As,ts] = season(...,'detrend',DetrendOption)| specifies a baseline relative to which seasonal anomalies are 
% determined. Options are |'linear'|, |'quadratic'|, |'mean'}, or |'none'|. By default, anomalies are calculated after 
% removing the linear least squares trend, but if, for example, warming is strongly nonlinear, you may prefer
% the |'quadratic'| option. Default is |'linear'|. 
%
% |[As,ts] = season(...,'dim',dimension)| specifies a dimension along which to assess seasons. By default, 
% if |A| is 1D, seasonal cycle is returned along the nonsingleton dimension; if |A| is 2D, season is performed
% along dimension 1 (time marches down the rows); if |A| is 3D, season is performed along dimension 3. 
% 
% |As = season(...,'full')| returns |As| for the entire time series |A|. This is a convenient option for looking
% at the components of a long time series separately. 
% 
%% Example 1: A single time series 
% Consider this time series. Let's call it temperature: 

t = datenum('jan 1, 1979'):datenum('dec 31, 2016'); 

% Sinusoidal seasonal signal + warming trend + noise + some mean value: 
T = 4*sin(doy(t,'decimalyear')*2*pi) + (t-min(t))/5e3 + randn(size(t)) + 15; 

plot(t,T)
axis tight
box off
datetick('x','keeplimits') 

%% 
% You can see the temperature has a seasonal cycle, but there's a gradual warming over time
% and there's also some random noise in there. To see the structure of the seasonal cycle a 
% little better, we can look at the same time series as a function of day of year using 
% the <doy_documentation.html |doy|> function. We'll also use the <cbdate_documentation.html |cbdate|> 
% function to format the colorbar dates. 

figure
scatter(doy(t),T,10,t,'filled')
axis tight

colorbar
cbdate('yyyy')
xlabel 'day of year'
ylabel 'temperature'
cmocean amp

%% 
% And again you can see the temperature rising over time, but by plotting as a function of |doy|
% we get to see the structure of the seasonal cycle a little better. Now what if we want to separate
% the effects of long-term warming from the seasonal cycle? 

Ts = season(T,t); 

figure
plot(1:366,Ts)
box off
axis tight
xlabel 'day of year' 
ylabel 'seasonal temperature cycle' 

%% 
% Above we see the seasonal cycle that has an amplitude of 4 degrees, just as we defined it. Some noise remains
% because each day of the year represents the average of 38 noisy measurements. Nonetheless, it's our best approximation
% of the seasonal cycle, and it's pretty close. 

%% Example 2: Multiple time series at once 
% Let's say you have several rows of data, each containing a different time series. 
% The data might look like this (we're building on the time series |T| from above)

T2 = [T + (t-min(t))/2e3;
      T - 15*cos(doy(t,'decimalyear')*2*pi) + (t-min(t))/1e2;
      T + ((t-min(t))/2.5e3).^3.1]; 
   
figure
plot(t,T2)
axis tight
box off
datetick('x','keeplimits') 
legend('first row of T2','second row of T2','third row of T2','location','northwest')
legend boxoff

%% 
% What's the annual cycle like for each of those time series? Use |season|, but specify dimension 2
% because each row of |T2| contains a time series. If each column of |T2| contained a time series, 
% the default dimension 1 would be what we want. 
% 
% Let's also get the whole time series with the |'full'| option rather than the default days 1 to 366. 

T2_full = season(T2,t,'dimension',2,'full'); 

figure
plot(t,T2_full)
axis([datenum('jan 1, 1995') datenum('jan 1, 2010') -16 16])
box off
datetick('x','keeplimits') 
 
legend('first row of T2','second row of T2','third row of T2','location','northwest')

%% 
% Above we see that |season| has extracted the seasonal cycles of each time series 
% in |T2|. Even row 3 of |T2|, which has a long term trend that scales to the power of 
% 3.1 is sufficiently analyzed using the default linear detrending. However, if linear detrending
% is insufficient for your application, use the |'detrend','quadratic'| option to step it 
% up a notch. 
% 
%% Removing seasonal cycles
% For convenience, the Climate Data Toolbox has a <deseason_documentation.html |deseason|> 
% function, but it's worth noting here, that the |deseason| function removes seasonal cycles
% just by subtracting the seasonal component from the original signals, like this: 

T_deseasoned = T2 - T2_full; 

figure
plot(t,T2) 
hold on

plot(t,T_deseasoned)
axis tight
box off
datetick('x','keeplimits') 
legend('first row of T2','second row of T2','third row of T2','location','northwest')
legend boxoff

%% Example 3: Real Sea Ice Data
% The examples above used some artifical data we created. But how does this function apply to
% real data? Let's compare the northern and southern hemisphere seasonal cycles of sea ice
% extent. Here's what the full time series look like: 

load seaice_extent

figure
plot(t,extent_N,'b')
hold on
plot(t,extent_S,'r')

axis tight
box off
legend('north','south','location','northwest') 

%% 
% So what's a typical year of sea ice look like?

figure
plot(season(extent_N,t),'b')
hold on
plot(season(extent_S,t),'r')

axis tight
box off
xlabel 'day of year'
ylabel('sea ice extent anomaly (10^6 km^2)') 
ntitle(' typical seasonal cycle ')
legend('north','south','location','northwest') 

%% Example 4: Gridded reanalysis data
% Let's explore the typical seasonal cycles of sea surface temperatures. Here's a monthly 
% dataset of dimensions 60x55x802: 

load pacific_sst 

sst_season = season(sst,t); 

%% 
% That gives us |sst_season|, which is 60x55x12, representing one 60x55 grid for each month of the
% year. Take the difference between the typical maximum and minimum temperatures to get a sense 
% of how strong the seasons are in different parts of the Pacific: 

T_range = max(sst_season,[],3)-min(sst_season,[],3); 

figure
imagescn(lon,lat,T_range)
cb = colorbar; 
ylabel(cb,'magnitude of seasonal cycle (\circ C)') 
cmocean amp

%% 
% That's not surprisingREPLACE_WITH_DASH_DASHSeasonality is strongest close to the poles and in shallow waters. 

%% How this function works
% By default, the |season| function removes the linear trend from a time series, then determines the climatology
% of the time series by averaging all detrended data for each day (or month) of the year. 
% 
% For daily data, Leap Years present a challenge. This function calculates the average temperature for February 28th
% by averaging all data corresponding to the 59th day of the year. But what to do about March 1st? Most years
% March 1st is the 60th day of the year, but every fourth year March 1st is the 61st day of the year. 
% 
% This function converts all dates to the day of the year, and calculates seasonal cycles as a function of day
% of the year. Since there are far fewer years with 366 days, applying the same practice of averaging all data
% from day 366 would make day 366 sensitive to outliers. Thus, for day 366, the |season| function averages all
% data from day 365, day 366, and day 1 of all years. 

%% Seasons vs Climatology
% CDT has a function called |season| and another function called <climatology_documentation.html |climatology|>. 
% The only difference is that the output of |climatology| includes the mean of the variable, 
% whereas the output of |season| will always have a 0 mean value. Accordingly, the <deseason_documentation.html |deseason|>
% function removes the seasonal component of variability while preserving the overall mean
% and trends. 
% 
% In general, CDT assumes that a multi-year record of a variable sampled at 
% subannual resolution can described by 
% 
%  y = y_0 + y_tr + y_season + y_var + y_noise
% 
%% 
% where 
% 
% * |y_0| is the long-term |mean|, 
% * |y_trend| is the long-term <trend_documentation.html |trend|>, 
% * |y_season| is the typical seasonal anomaly, which the |season| function obtains after detrending and removing the mean, 
% * |y_var| represents interannual variability, and 
% * |y_noise| is everything else 
% 
% In this model, 
% 
%  y_climatology = y_0 + y_season
% 
%% Other ways to define seasonality 
% For yet another way to define seasonality, see <sinefit_documentation.html |sinefit|>, 
% <sineval_documentation.html |sineval|>, and <sinefit_bootstrap_documentation.html |sinefit_bootstrap|>. 
%% Author Info
% This function was written by <http://www.chadagreene.com Chad A. Greene> of the University of Texas Institute
% for Geophysics (UTIG), July 2017. 
##### SOURCE END #####
--></body></html>